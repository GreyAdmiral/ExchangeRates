"use strict";async function money(e){try{let t=await Promise.allSettled([fetch(e+"0").then(e=>e.json()),fetch(e+"1").then(e=>e.json())]);if(!t.filter(e=>"fulfilled"==e.status).length)throw new Error([...new Set(t.map(e=>e.reason.message))].join(". "));let o=t.reduce((e,t,o)=>("fulfilled"==t.status?e.push(...t.value):console.error(`Ошибка обработки запроса №${o+1}: ${t.reason.message}`),e),[]);o.sort((e,t)=>e.Cur_Name.localeCompare(t.Cur_Name)),generalProcessing(o)}catch(e){moneyError(e)}}function generalProcessing(e){e.forEach(e=>moneyLine(e)),table.append(fragment),sortLabel("Валюта"),document.addEventListener("dblclick",doubleClick),search.addEventListener("input",t=>{let o=e.filter(e=>e.Cur_Name.toLowerCase().includes(t.target.value.toLowerCase())||e.Cur_Abbreviation.toLowerCase().includes(t.target.value.toLowerCase())),n=table.querySelectorAll(".money__item--row");o.forEach(e=>moneyLine(e)),n.forEach(e=>e.remove()),table.append(fragment)})}function moneyLine(e){let{Cur_ID:t,Cur_Abbreviation:o,Cur_Scale:n,Cur_Name:r,Cur_OfficialRate:a,Date:l}=e,c=l.split("T")[0].split("-").reverse().join("."),s=[...document.querySelectorAll(".money__item--title > span")],i=document.createElement("div");i.classList.add("money__item","money__item--row"),i.id=t,i.innerHTML=`<span data-text="${s[0].textContent}">${o}</span><span data-text="${s[1].textContent}">${n}</span><span data-text="${s[2].textContent}">${r}</span><span data-text="${s[3].textContent}">${a}</span><span data-text="${s[4].textContent}">${c}</span>`,fragment.append(i)}function moneyError(e){let t=document.createElement("span"),o=document.querySelector(".footer"),n=document.querySelector(".money__item--title");n.remove(),o.remove(),t.classList.add("money__error"),t.textContent="Произошла ошибка!",console.error(e),table.append(t)}function copyCell(e){navigator.clipboard?navigator.clipboard.writeText(e.textContent).catch(e=>console.log(e)):window.getSelection()?(document.getSelection().selectAllChildren(e),document.execCommand("copy"),document.getSelection().empty()):document.body.createTextRange&&(range=document.body.createTextRange(),range.moveToElementText(e),range.select(),document.execCommand("copy")),document.getSelection().selectAllChildren(e)}function sortCell(e,t){let o=`[data-text="${sortText}"]`,n=e.querySelector(o).textContent,r=t.querySelector(o).textContent,a=e=>e.split(".").reverse().join("-");switch(Number.isNaN(+n)){case!0:return"Дата"==sortText?a(n).localeCompare(a(r)):n.localeCompare(r);case!1:return n-r}}function sortLabel(e){document.querySelectorAll(".money__item--title span").forEach(t=>{if(t.textContent===e)switch(t.dataset.sort){case"down":t.dataset.sort="up";break;default:t.dataset.sort="down"}else t.removeAttribute("data-sort")})}function changeSort(e,t){switch(t.dataset.sort){case"down":domTableSort=e.sort(sortCell);break;case"up":domTableSort=e.sort(sortCell).reverse()}}function doubleClick(e){if(e.stopPropagation(),e.target.closest(".money__item--row > span")&&copyCell(e.target),e.target.closest(".money__item--row > span")||document.getSelection().empty(),e.target.closest(".money__item--title > span")){sortText=e.target.textContent;let t=[...document.getElementsByClassName("money__item--row")],o=new DocumentFragment,n=e.target;sortLabel(sortText),changeSort(t,n),t.forEach((e,t)=>{e.remove(),o.append(domTableSort[t])}),table.append(o)}e.target.closest(".header__title>span")&&(searchBlock.hidden=!searchBlock.hidden)}function arrowUpVisible(){let e=arrowUp.classList.contains("transparency");document.body.scrollTop>550||document.documentElement.scrollTop>550?e&&arrowUp.classList.remove("transparency"):e||arrowUp.classList.add("transparency")}function arrowUpClick(e){e.stopPropagation(),window.scrollTo({top:0,left:0,behavior:"smooth"})}function trottle(e,t){let o=!1,n=null,r=null;return function a(...l){if(o)return n=l,void(r=this);e.apply(this,l),o=!0,setTimeout(()=>{o=!1,r&&(a.apply(r,n),r=null,n=null)},t)}}let sortText,domTableSort,table=document.querySelector(".money__table"),searchBlock=document.querySelector(".main__search"),search=document.querySelector(".search__body > input"),headerTitle=document.querySelector(".header__title"),fragment=new DocumentFragment,arrowUp=document.querySelector(".topbutton"),documentWidth=Math.max(document.documentElement.clientWidth,document.body.clientWidth,document.documentElement.offsetWidth,document.body.offsetWidth,document.documentElement.scrollWidth,document.body.scrollWidth);const URL="https://www.nbrb.by/api/exrates/rates?periodicity=";money(URL),window.onscroll=(()=>trottle(arrowUpVisible(),1e3)),arrowUp.onclick=(e=>arrowUpClick(e));{let e;search.addEventListener("focusin",t=>{t.stopPropagation(),t.target.hasAttribute("placeholder")&&(e=t.target.placeholder,t.target.placeholder="")}),search.addEventListener("focusout",t=>{t.stopPropagation(),t.target.hasAttribute("placeholder")&&(t.target.placeholder=e)})}documentWidth>768&&(document.addEventListener("copy",e=>e.preventDefault()),document.addEventListener("cut",e=>e.preventDefault()),document.addEventListener("paste",e=>e.preventDefault()),document.addEventListener("contextmenu",e=>e.preventDefault())),Number.isNaN||(Number.isNaN=function(e){return"number"==typeof e&&isNaN(e)});